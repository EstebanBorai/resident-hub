#!/bin/bash

# Sets environment variables as defined in ".env.sample" and runs
# `docker run` command

ADMIN_EMAIL='admin@resident-hub.com'
ADMIN_PASSWORD='root'
NEXT_TELEMETRY_DISABLED=1
JWT_TOKEN_COOKIE_NAME='resident-hub::token'
JWT_REFRESH_TOKEN_COOKIE_NAME='resident-hub::refresh_token'
JWT_EXPIRATION='15m'
JWT_REFRESH_TOKEN_EXPIRATION='12h'
JWT_PRIVATE_KEY='resident-hub'
APPLICATION_DOMAIN='0.0.0.0'
COOKIE_SIGNATURE='resident-hub'
PORT=3000
MONGO_URL='mongodb://database/resident-hub'

docker run \
  -p $PORT:$PORT \
  -e NODE_ENV='production' \
  -e ADMIN_EMAIL=$ADMIN_EMAIL \
  -e ADMIN_PASSWORD=$ADMIN_PASSWORD \
  -e NEXT_TELEMETRY_DISABLED=$NEXT_TELEMETRY_DISABLED \
  -e JWT_TOKEN_COOKIE_NAME=$JWT_TOKEN_COOKIE_NAME \
  -e JWT_REFRESH_TOKEN_COOKIE_NAME=$JWT_REFRESH_TOKEN_COOKIE_NAME \
  -e JWT_EXPIRATION=$JWT_EXPIRATION \
  -e JWT_REFRESH_TOKEN_EXPIRATION=$JWT_REFRESH_TOKEN_EXPIRATION \
  -e JWT_PRIVATE_KEY=$JWT_PRIVATE_KEY \
  -e APPLICATION_DOMAIN=$APPLICATION_DOMAIN \
  -e COOKIE_SIGNATURE=$COOKIE_SIGNATURE \
  -e PORT=$PORT \
  -e MONGO_URL=$MONGO_URL \
  resident-hub
